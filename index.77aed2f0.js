let e,t,s,n,o,a,d,l,r,i,u,c,p,m,v;function L(L){if(!L)return TypeError("The file is missing");r=(l=L).size,d=performance.now(),function L(h=!1){let g,f;if(c)return console.debug("Still offline ..."),setTimeout(L,1e3,h);// Wait for online and retry.
(u=i+n)>r&&(u=r);let E=l.slice(i,u);!h&&a++,((g=new FormData).append("file",E),g.append("upload_preset",s),g.append("cloud_name",e),g.append("public_id",t),f=new XMLHttpRequest,new Promise((t,s)=>{f.open("POST",`https://api.cloudinary.com/v1_1/${e}/auto/upload`),f.setRequestHeader("X-Unique-Upload-Id",o),f.setRequestHeader("Content-Range",`bytes ${i}-${u-1}/${r}`),f.onload=()=>{4===f.readyState&&t(f);// Only run if the request is complete (4 == Done)
},f.upload.onloadstart=()=>{// Fired when a request has started to load data
},f.upload.onloadend=()=>{// Fired when a request has been completed, whether successfully (after load) or unsuccessfully (after abort or error)
},f.upload.onabort=()=>{// Fired when a request has been aborted, for example, because the program called XMLHttpRequest.abort().
t(f)},f.upload.onprogress=e=>{// Fired periodically when a request receives more data
let t=Math.max(e.total,r),s=(a-1)*n+e.loaded,o=(performance.now()-d)/1e3;v.dispatchEvent(new CustomEvent("progress",{detail:{percent:s/t*100,speed:s/o,uploaded:s,total:t}}))},f.upload.ontimeout=()=>{// Fired when progress is terminated due to preset time expiring.
t(f)},f.upload.onerror=()=>{// Fired when the request encountered an error.
t(f)},f.send(g)})).then(e=>{if(e.status/100==2)m=0,u<r?(i=u,console.debug(`Uploaded chunk number ${a}`),L()):v.dispatchEvent(new CustomEvent("success",{detail:{response:JSON.parse(e.response)}}));else{if(m<p)return console.debug(`${++m}/${p} retries to upload chunk number ${a}`),setTimeout(L,1e3,!0);// Retry with count.
v.dispatchEvent(new CustomEvent("error",{detail:e}))}}).catch(e=>{console.error(e)})}()}window.addEventListener("online",()=>{c=!1,console.debug("Online")}),window.addEventListener("offline",()=>{c=!0,console.debug("Offline")});let h=document.getElementById("picker"),g=document.getElementById("clear"),f=document.getElementById("status"),E=document.getElementById("progress"),w=document.getElementById("url"),y=document.getElementById("err"),b=document.getElementById("info"),$=document.querySelector(".container"),B=document.querySelector(".progress-tools"),T=document.querySelector(".upload-tools"),M=document.querySelector(".finish-tools");function I(d){var l;let r=new URLSearchParams(window.location.search),h=(l={cloudName:r.get("cloud_name")||"demo",uploadPreset:r.get("upload_preset")||"unsigned"},o=+new Date,t=l&&l.publicId||o,e=l&&l.cloudName||"demo",s=l&&l.uploadPreset||"unsigned",n=6e6,i=0,u=0,c=!1,a=0,p=5,m=0,{on:v=new EventTarget,uploadFile:L});h.uploadFile(d),h.on.addEventListener("progress",e=>{E.value=Math.round(e.detail.percent),f.innerHTML=`${Math.round(e.detail.percent)}%`;let t=_(e.detail.speed);b.innerHTML=`${t[0]} ${t[1]}/s`}),h.on.addEventListener("success",e=>{let t=e.detail.response,s=t.playback_url;"video"!==t.resource_type&&(s=t.secure_url),w.innerHTML=s,w.href=s,S()}),h.on.addEventListener("error",e=>{y.innerHTML=`Error during the upload: [${e.detail.status}] ${e.detail.message}.`,S()})}function P(){B.classList.add("show"),B.classList.remove("hide"),T.classList.add("hide"),T.classList.remove("show"),M.classList.add("hide"),M.classList.remove("show")}function S(){B.classList.add("hide"),B.classList.remove("show"),T.classList.add("hide"),T.classList.remove("show"),M.classList.add("show"),M.classList.remove("hide")}g.addEventListener("click",e=>{h.value&&(h.disabled=null,E.value=0,f.innerHTML="0%",w.innerHTML=null,w.href=null,B.classList.add("hide"),B.classList.remove("show"),T.classList.add("show"),T.classList.remove("hide"),M.classList.add("hide"),M.classList.remove("show"))}),h.addEventListener("input",e=>{let t=h.files[0];I(t),h.disabled="disabled";let s=_(t.size);console.debug(`Name: ${t.name} Size: ${s[0]} ${s[1]} Type: ${t.type}`),P()}),$.addEventListener("dragenter",e=>{h.value||(e.preventDefault(),e.stopPropagation(),$.classList.add("active"))},!1),$.addEventListener("dragleave",e=>{h.value||(e.preventDefault(),e.stopPropagation(),$.classList.remove("active"))},!1),$.addEventListener("dragover",e=>{h.value||(e.preventDefault(),e.stopPropagation(),$.classList.add("active"))},!1),$.addEventListener("drop",e=>{h.value||(e.preventDefault(),e.stopPropagation(),$.classList.remove("active"),I(e.dataTransfer.files[0]),P())},!1);const H=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];function _(e){let t=0,s=parseInt(e,10)||0;for(;s>=1e3&&++t;)s/=1e3;return[s.toFixed(s<10&&t>0?1:0),H[t]]}//# sourceMappingURL=index.77aed2f0.js.map

//# sourceMappingURL=index.77aed2f0.js.map
