let e,t,s,n,a,o,d,l,r,i,u,c,p,m,v,h;function L(L){if(!L)return TypeError("The file is missing");d=Math.ceil((i=(r=L).size)/n),l=Date.now(),function L(f=!1){let g,w;if(p)return console.debug("Still offline ..."),setTimeout(L,1e3,f);// Wait for online and retry.
(c=u+n)>i&&(c=i);let E=r.slice(u,c);!f&&o++,((g=new FormData).append("file",E),g.append("upload_preset",s),g.append("cloud_name",e),g.append("public_id",t),w=new XMLHttpRequest,new Promise((t,s)=>{w.open("POST",`https://api.cloudinary.com/v1_1/${e}/auto/upload`),w.setRequestHeader("X-Unique-Upload-Id",a),w.setRequestHeader("Content-Range",`bytes ${u}-${c-1}/${i}`),w.onload=()=>{t(w)},w.onloadstart=()=>{// Fired when a request has started to load data
},w.onloadend=()=>{// Fired when a request has been completed, whether successfully (after load) or unsuccessfully (after abort or error)
},w.onabort=()=>{// Fired when a request has been aborted, for example, because the program called XMLHttpRequest.abort().
t(w)},w.onprogress=e=>{// Fired periodically when a request receives more data
let t=Math.max(e.total,i),s=(o-1)*n+e.loaded,a=(Date.now()-l)/1e3;// Bytes
h.dispatchEvent(new CustomEvent("progress",{detail:{percent:s/t*100,speed:Math.max(s/a,1),uploaded:s,total:t}}))},w.ontimeout=()=>{// Fired when progress is terminated due to preset time expiring.
t(w)},w.onerror=()=>{// Fired when the request encountered an error.
t(w)},w.send(g)})).then(e=>{if(e.status/100==2)v=0,c<i?(u=c,console.debug(`Uploaded chunk ${o}/${d}`),L()):h.dispatchEvent(new CustomEvent("success",{detail:{response:JSON.parse(e.response)}}));else{if(v<m)return console.debug(`${++v}/${m} retries chunk ${o}`),setTimeout(L,1e3,!0);// Retry with count.
h.dispatchEvent(new CustomEvent("error",{detail:e}))}}).catch(e=>{console.error(e)})}()}window.addEventListener("online",()=>{p=!1,console.debug("Online")}),window.addEventListener("offline",()=>{p=!0,console.debug("Offline")});let f=document.getElementById("picker"),g=document.getElementById("clear"),w=document.getElementById("status"),E=document.getElementById("progress"),$=document.getElementById("url"),y=document.getElementById("err"),T=document.getElementById("info"),M=document.getElementById("completed"),b=document.querySelector(".container"),B=document.querySelector(".progress-tools"),H=document.querySelector(".upload-tools"),I=document.querySelector(".finish-tools");function S(d){var l;Date.now();let r=new URLSearchParams(window.location.search),i=(l={cloudName:r.get("cloud_name")||"demo",uploadPreset:r.get("upload_preset")||"unsigned"},a=+new Date,t=l&&l.publicId||a,e=l&&l.cloudName||"demo",s=l&&l.uploadPreset||"unsigned",n=6e6,u=0,c=0,p=!1,o=0,m=5,v=0,{on:h=new EventTarget,uploadFile:L});i.uploadFile(d),i.on.addEventListener("progress",e=>{E.value=Math.round(e.detail.percent),w.innerHTML=`${Math.round(e.detail.percent)}%`;let t=_(e.detail.speed),s=Math.max(Math.max(e.detail.total-e.detail.uploaded,0)/e.detail.speed,0),n=_(e.detail.uploaded),a=_(e.detail.total);T.innerHTML=`${t[0]} ${t[1]}/s \xb7 ${n[0]} ${n[1]}/${a[0]} ${a[1]} \xb7 ${function(e){let t=Math.floor(e/3600),s=Math.floor(e%3600/60),n=Math.round(e%60);return[t,s>9?s:t?"0"+s:s||"0",n>9?n:"0"+n].filter(Boolean).join(":")}//# sourceMappingURL=index.3b4c50e7.js.map
(s)} left`}),i.on.addEventListener("success",e=>{M.innerHTML="Upload Completed Successfully!";let t=e.detail.response,s=t.playback_url;"video"!==t.resource_type&&(s=t.secure_url),$.innerHTML=s,$.href=s,P()}),i.on.addEventListener("error",e=>{if(M.innerHTML="There was an upload error",e.detail.responseText){let t=JSON.parse(e.detail.responseText).error.message;y.innerHTML=`${e.detail.status} (${e.detail.statusText}) - ${t}`}P()})}function x(){B.classList.add("show"),B.classList.remove("hide"),H.classList.add("hide"),H.classList.remove("show"),I.classList.add("hide"),I.classList.remove("show")}function P(){B.classList.add("hide"),B.classList.remove("show"),H.classList.add("hide"),H.classList.remove("show"),I.classList.add("show"),I.classList.remove("hide")}g.addEventListener("click",e=>{f.value&&(f.disabled=null,E.value=0,w.innerHTML="0%",$.innerHTML=null,$.href=null,B.classList.add("hide"),B.classList.remove("show"),H.classList.add("show"),H.classList.remove("hide"),I.classList.add("hide"),I.classList.remove("show"))}),f.addEventListener("input",e=>{let t=f.files[0];S(t),f.disabled="disabled";let s=_(t.size);console.debug(`Name: ${t.name} Size: ${s[0]} ${s[1]} Type: ${t.type}`),x()}),b.addEventListener("dragenter",e=>{f.value||(e.preventDefault(),e.stopPropagation(),b.classList.add("active"))},!1),b.addEventListener("dragleave",e=>{f.value||(e.preventDefault(),e.stopPropagation(),b.classList.remove("active"))},!1),b.addEventListener("dragover",e=>{f.value||(e.preventDefault(),e.stopPropagation(),b.classList.add("active"))},!1),b.addEventListener("drop",e=>{f.value||(e.preventDefault(),e.stopPropagation(),b.classList.remove("active"),S(e.dataTransfer.files[0]),x())},!1);const D=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];function _(e){let t=0,s=parseInt(e,10)||0;for(;s>=1e3&&++t;)s/=1e3;return[s.toFixed(s<10&&t>0?1:0),D[t]]}
//# sourceMappingURL=index.3b4c50e7.js.map
