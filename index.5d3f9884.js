let e,t,s,o,n,a,d,l,r,i,u,c,p,m,v;function L(L){if(!L)return TypeError("The file is missing");r=(l=L).size,d=Date.now(),function L(h=!1){let f,g;if(c)return console.debug("Still offline ..."),setTimeout(L,1e3,h);// Wait for online and retry.
(u=i+o)>r&&(u=r);let E=l.slice(i,u);!h&&a++,((f=new FormData).append("file",E),f.append("upload_preset",s),f.append("cloud_name",e),f.append("public_id",t),g=new XMLHttpRequest,new Promise((t,s)=>{g.open("POST",`https://api.cloudinary.com/v1_1/${e}/auto/upload`),g.setRequestHeader("X-Unique-Upload-Id",n),g.setRequestHeader("Content-Range",`bytes ${i}-${u-1}/${r}`),g.onload=()=>{4===g.readyState&&t(g);// Only run if the request is complete (4 == Done)
},g.upload.onloadstart=()=>{// Fired when a request has started to load data
},g.upload.onloadend=()=>{// Fired when a request has been completed, whether successfully (after load) or unsuccessfully (after abort or error)
},g.upload.onabort=()=>{// Fired when a request has been aborted, for example, because the program called XMLHttpRequest.abort().
t(g)},g.upload.onprogress=e=>{// Fired periodically when a request receives more data
let t=Math.max(e.total,r),s=(a-1)*o+e.loaded,n=(Date.now()-d)/1e3;v.dispatchEvent(new CustomEvent("progress",{detail:{percent:s/t*100,speed:s/n,uploaded:s,total:t}}))},g.upload.ontimeout=()=>{// Fired when progress is terminated due to preset time expiring.
t(g)},g.upload.onerror=()=>{// Fired when the request encountered an error.
t(g)},g.send(f)})).then(e=>{if(e.status/100==2)m=0,u<r?(i=u,console.debug(`Uploaded chunk number ${a}`),L()):v.dispatchEvent(new CustomEvent("success",{detail:{response:JSON.parse(e.response)}}));else{if(m<p)return console.debug(`${++m}/${p} retries to upload chunk number ${a}`),setTimeout(L,1e3,!0);// Retry with count.
v.dispatchEvent(new CustomEvent("error",{detail:e}))}}).catch(e=>{console.error(e)})}()}window.addEventListener("online",()=>{c=!1,console.debug("Online")}),window.addEventListener("offline",()=>{c=!0,console.debug("Offline")});let h=document.getElementById("picker"),f=document.getElementById("clear"),g=document.getElementById("status"),E=document.getElementById("progress"),w=document.getElementById("url"),$=document.getElementById("err"),y=document.getElementById("info"),b=document.querySelector(".container"),B=document.querySelector(".progress-tools"),T=document.querySelector(".upload-tools"),M=document.querySelector(".finish-tools");function I(d){var l;let r=new URLSearchParams(window.location.search),h=(l={cloudName:r.get("cloud_name")||"demo",uploadPreset:r.get("upload_preset")||"unsigned"},n=+new Date,t=l&&l.publicId||n,e=l&&l.cloudName||"demo",s=l&&l.uploadPreset||"unsigned",o=6e6,i=0,u=0,c=!1,a=0,p=5,m=0,{on:v=new EventTarget,uploadFile:L});h.uploadFile(d),h.on.addEventListener("progress",e=>{E.value=Math.round(e.detail.percent),g.innerHTML=`${Math.round(e.detail.percent)}%`;let t=_(e.detail.speed),s=(e.detail.total-e.detail.uploaded)/e.detail.speed,o=_(e.detail.uploaded),n=_(e.detail.total);y.innerHTML=`${t[0]} ${t[1]}/s \xb7 ${o[0]} ${o[1]}/${n[0]} ${n[1]} \xb7 ${function(e){let t=Math.floor(e/3600),s=Math.floor(e%3600/60),o=Math.round(e%60);return[t,s>9?s:t?"0"+s:s||"0",o>9?o:"0"+o].filter(Boolean).join(":")}//# sourceMappingURL=index.5d3f9884.js.map
(s)} left`}),h.on.addEventListener("success",e=>{let t=e.detail.response,s=t.playback_url;"video"!==t.resource_type&&(s=t.secure_url),w.innerHTML=s,w.href=s,S()}),h.on.addEventListener("error",e=>{$.innerHTML=`Error during the upload: [${e.detail.status}] ${e.detail.message}.`,S()})}function P(){B.classList.add("show"),B.classList.remove("hide"),T.classList.add("hide"),T.classList.remove("show"),M.classList.add("hide"),M.classList.remove("show")}function S(){B.classList.add("hide"),B.classList.remove("show"),T.classList.add("hide"),T.classList.remove("show"),M.classList.add("show"),M.classList.remove("hide")}f.addEventListener("click",e=>{h.value&&(h.disabled=null,E.value=0,g.innerHTML="0%",w.innerHTML=null,w.href=null,B.classList.add("hide"),B.classList.remove("show"),T.classList.add("show"),T.classList.remove("hide"),M.classList.add("hide"),M.classList.remove("show"))}),h.addEventListener("input",e=>{let t=h.files[0];I(t),h.disabled="disabled";let s=_(t.size);console.debug(`Name: ${t.name} Size: ${s[0]} ${s[1]} Type: ${t.type}`),P()}),b.addEventListener("dragenter",e=>{h.value||(e.preventDefault(),e.stopPropagation(),b.classList.add("active"))},!1),b.addEventListener("dragleave",e=>{h.value||(e.preventDefault(),e.stopPropagation(),b.classList.remove("active"))},!1),b.addEventListener("dragover",e=>{h.value||(e.preventDefault(),e.stopPropagation(),b.classList.add("active"))},!1),b.addEventListener("drop",e=>{h.value||(e.preventDefault(),e.stopPropagation(),b.classList.remove("active"),I(e.dataTransfer.files[0]),P())},!1);const H=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];function _(e){let t=0,s=parseInt(e,10)||0;for(;s>=1e3&&++t;)s/=1e3;return[s.toFixed(s<10&&t>0?1:0),H[t]]}
//# sourceMappingURL=index.5d3f9884.js.map
