let e,t,a,s,o,n,d,l,r,i,u,c,p,m,v;function h(h){if(!h)return TypeError("The file is missing");r=(l=h).size,d=Date.now(),function h(L=!1){let f,g;if(c)return console.debug("Still offline ..."),setTimeout(h,1e3,L);// Wait for online and retry.
(u=i+s)>r&&(u=r);let E=l.slice(i,u);!L&&n++,((f=new FormData).append("file",E),f.append("upload_preset",a),f.append("cloud_name",e),f.append("public_id",t),g=new XMLHttpRequest,new Promise((t,a)=>{g.open("POST",`https://api.cloudinary.com/v1_1/${e}/auto/upload`),g.setRequestHeader("X-Unique-Upload-Id",o),g.setRequestHeader("Content-Range",`bytes ${i}-${u-1}/${r}`),g.onload=()=>{4===g.readyState&&t(g);// Only run if the request is complete (4 == Done)
},g.upload.onloadstart=()=>{// Fired when a request has started to load data
},g.upload.onloadend=()=>{// Fired when a request has been completed, whether successfully (after load) or unsuccessfully (after abort or error)
},g.upload.onabort=()=>{// Fired when a request has been aborted, for example, because the program called XMLHttpRequest.abort().
t(g)},g.upload.onprogress=e=>{// Fired periodically when a request receives more data
let t=Math.max(e.total,r),a=(n-1)*s+e.loaded,o=(Date.now()-d)/1e3;// Bytes
v.dispatchEvent(new CustomEvent("progress",{detail:{percent:a/t*100,speed:Math.max(a/o,1),uploaded:a,total:t}}))},g.upload.ontimeout=()=>{// Fired when progress is terminated due to preset time expiring.
t(g)},g.upload.onerror=()=>{// Fired when the request encountered an error.
t(g)},g.send(f)})).then(e=>{if(e.status/100==2)m=0,u<r?(i=u,console.debug(`Uploaded chunk number ${n}`),h()):v.dispatchEvent(new CustomEvent("success",{detail:{response:JSON.parse(e.response)}}));else{if(m<p)return console.debug(`${++m}/${p} retries to upload chunk number ${n}`),setTimeout(h,1e3,!0);// Retry with count.
v.dispatchEvent(new CustomEvent("error",{detail:e}))}}).catch(e=>{console.error(e)})}()}window.addEventListener("online",()=>{c=!1,console.debug("Online")}),window.addEventListener("offline",()=>{c=!0,console.debug("Offline")});let L=document.getElementById("picker"),f=document.getElementById("clear"),g=document.getElementById("status"),E=document.getElementById("progress"),w=document.getElementById("url"),$=document.getElementById("err"),y=document.getElementById("info"),b=document.querySelector(".container"),M=document.querySelector(".progress-tools"),B=document.querySelector(".upload-tools"),T=document.querySelector(".finish-tools");function I(d){var l;Date.now();let r=new URLSearchParams(window.location.search),L=(l={cloudName:r.get("cloud_name")||"demo",uploadPreset:r.get("upload_preset")||"unsigned"},o=+new Date,t=l&&l.publicId||o,e=l&&l.cloudName||"demo",a=l&&l.uploadPreset||"unsigned",s=6e6,i=0,u=0,c=!1,n=0,p=5,m=0,{on:v=new EventTarget,uploadFile:h});L.uploadFile(d),L.on.addEventListener("progress",e=>{E.value=Math.round(e.detail.percent),g.innerHTML=`${Math.round(e.detail.percent)}%`;let t=H(e.detail.speed),a=Math.max(Math.max(e.detail.total-e.detail.uploaded,0)/e.detail.speed,0),s=H(e.detail.uploaded),o=H(e.detail.total);y.innerHTML=`${t[0]} ${t[1]}/s \xb7 ${s[0]} ${s[1]}/${o[0]} ${o[1]} \xb7 ${function(e){let t=Math.floor(e/3600),a=Math.floor(e%3600/60),s=Math.round(e%60);return[t,a>9?a:t?"0"+a:a||"0",s>9?s:"0"+s].filter(Boolean).join(":")}//# sourceMappingURL=index.b72c350a.js.map
(a)} left`}),L.on.addEventListener("success",e=>{let t=e.detail.response,a=t.playback_url;"video"!==t.resource_type&&(a=t.secure_url),w.innerHTML=a,w.href=a,S()}),L.on.addEventListener("error",e=>{$.innerHTML=`Error during the upload: [${e.detail.status}] ${e.detail.message}.`,S()})}function P(){M.classList.add("show"),M.classList.remove("hide"),B.classList.add("hide"),B.classList.remove("show"),T.classList.add("hide"),T.classList.remove("show")}function S(){M.classList.add("hide"),M.classList.remove("show"),B.classList.add("hide"),B.classList.remove("show"),T.classList.add("show"),T.classList.remove("hide")}f.addEventListener("click",e=>{L.value&&(L.disabled=null,E.value=0,g.innerHTML="0%",w.innerHTML=null,w.href=null,M.classList.add("hide"),M.classList.remove("show"),B.classList.add("show"),B.classList.remove("hide"),T.classList.add("hide"),T.classList.remove("show"))}),L.addEventListener("input",e=>{let t=L.files[0];I(t),L.disabled="disabled";let a=H(t.size);console.debug(`Name: ${t.name} Size: ${a[0]} ${a[1]} Type: ${t.type}`),P()}),b.addEventListener("dragenter",e=>{L.value||(e.preventDefault(),e.stopPropagation(),b.classList.add("active"))},!1),b.addEventListener("dragleave",e=>{L.value||(e.preventDefault(),e.stopPropagation(),b.classList.remove("active"))},!1),b.addEventListener("dragover",e=>{L.value||(e.preventDefault(),e.stopPropagation(),b.classList.add("active"))},!1),b.addEventListener("drop",e=>{L.value||(e.preventDefault(),e.stopPropagation(),b.classList.remove("active"),I(e.dataTransfer.files[0]),P())},!1);const D=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];function H(e){let t=0,a=parseInt(e,10)||0;for(;a>=1e3&&++t;)a/=1e3;return[a.toFixed(a<10&&t>0?1:0),D[t]]}
//# sourceMappingURL=index.b72c350a.js.map
